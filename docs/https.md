# Https

Соглашаемся с недоверенным сертификатом (мы починим это позднее). ![ERR_CERT_AUTHORITY_INVALID](
    screens/ERR_CERT_AUTHORITY_INVALID.png) Вы должны увидеть кастомный блок `ExtExchangeRates`.

## Решаем проблемы с сертификтом

Несмотря на то, что невалидный сертификат не влияет на работу компонента, он может сильно раздражать, а
`http` хост мы использовать не можем. Давайте починим это:

### Использование туннелера

Первый и рекомендованный способ — проксировать запрос на `http` хост. В примере мы будем настраивать
`ngrok`, но если он вам почему-то не подходит, существуют альтернативы, например
[`cloudflare argo`](https://www.cloudflare.com/products/argo-tunnel/) или
[go-http-tunnel](https://github.com/mmatczuk/go-http-tunnel).

1. Нужно зарегистрироваться или авторизоваться на https://ngrok.com
2. Получаем и копируем token ![authtoken](screens/authtoken.png)
3. Устанавливаем npm-версию клиента [`ngrok`](https://www.npmjs.com/package/ngrok)
4. Сохраняем токен `ngrok authtoken <your-auth-token>`
5. В корне репозитория запускаем `npm start`
6. В отдельном табе консоли выполняем команду `ngrok http 8081` и переходим на `https` версию туннеля.

### Настройка браузеров

В качестве альтернативы можно настроить бразуер:


Например, `yandex browser`
позволяет использовать самоподписанный сертификат для `localhost`.
Для этого необходимо открыть в новой вкладке `browser://flags` и через поиск найти #allow-insecure-localhost и включить его.

Похожую настройку имеет и mozilla firefox: вкладка `about:config` и настройка `network.websocket.allowInsecureFromHTTPS` (**обратите внимание, что он
выключает проверку не только localhost! не забудьте выключить после окончания разработки**).

### Создание корневого сертификата

Немного более радикальный способ — сгенерировать `rootCa` сертификат с
помощью утилиты: https://github.com/FiloSottile/mkcert. Получившиеся ключи
нужно положить в `/keys`. **Ключи нельзя коммитить, т.к. они дают возможность подменять трафик вашего компьютера**.

